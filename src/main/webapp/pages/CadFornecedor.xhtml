<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="/templates/modeloSistema.xhtml">

    <ui:define name="menu">
        <ui:include src="/includes/menuPrincipal.xhtml" />
    </ui:define>

    <ui:define name="Conteudo">



        <h:form id="formCadFornecedor">
            <h:body>
                <p:growl id="growl" sticky="true" showDetail="true" life="3000" />


                <p:dialog widgetVar="dlgNovo" closable="false" draggable="false"
                          resizable="false" appendTo="@(body)" header="CADASTRO DE FORNECEDOR"
                          modal="true">
                    <!-- header="" nomea o dialogo
                    
                    modal="true" appendTo="@(body)" : desabilita todo campo atras do dialogo-->
                    <h:form id="formDlgNovo">

                        <h:panelGrid columns="2" id="painelDlgNovo">

                            <p:outputLabel value="Tipo de Pessoa:" />

                            <h:selectOneRadio id="pessoa"
                                              value="#{MBFornecedor.fornecedor.pessoa}" required="true"
                                              requiredMessage="Campo [Pessoa] é obrigatório.">

                                <f:selectItem itemLabel="Jurídica" itemValue="Jurídica" />
                                <f:selectItem itemLabel="Física" itemValue="Física" />
                                <p:ajax event="change" update="painelDlgNovo" process="pessoa" />
                            </h:selectOneRadio>


                            <h:outputLabel value="CPF:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa=='Física'}" />

                            <h:outputLabel value="CNPJ:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa=='Jurídica'}" />

                            <p:inputMask mask="999.999.999-99" id="cpf" size="20"
                                         rendered="#{MBFornecedor.fornecedor.pessoa=='Física'}"
                                         value="#{MBFornecedor.fornecedor.cnpjCpf}" />

                            <p:inputMask mask="99.999.999/9999-99" id="cnpj" size="20"
                                         rendered="#{MBFornecedor.fornecedor.pessoa=='Jurídica'}"
                                         value="#{MBFornecedor.fornecedor.cnpjCpf}" />



                            <p:outputLabel value="Insc. Estadual:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa==null}" />
                            <p:outputLabel value="Insc. Estadual:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa=='Jurídica'}" />
                            <p:outputLabel value="RG:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa=='Física'}" />

                            <p:inputText size="20" required="true" maxlength="15"
                                         requiredMessage="Informe a inscrição estadual!"
                                         value="#{MBFornecedor.fornecedor.inscricaoEstadual}">
                            </p:inputText>


                            <p:outputLabel value="Razão Social:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa==null}" />
                            <p:outputLabel value="Razão Social:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa=='Jurídica'}" />
                            <p:outputLabel value="Nome:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa=='Física'}" />

                            <p:inputText id="txtRazaoSocial" size="45" maxlength="45"
                                         value="#{MBFornecedor.fornecedor.razaoSocialNome}" required="true"
                                         requiredMessage="Informe a Razão social da Pessoa Juridica ou Nome da Pessoa fisíca!">
                            </p:inputText>

                            <p:outputLabel value="Contato:"
                                           rendered="#{MBFornecedor.fornecedor.pessoa=='Jurídica'}" />
                            <p:inputText id="txtContato" size="20" maxlength="20"
                                         rendered="#{MBFornecedor.fornecedor.pessoa=='Jurídica'}"
                                         value="#{MBFornecedor.fornecedor.contato}">
                            </p:inputText>

                            <p:outputLabel value="Telefone:" />
                            <p:inputMask mask="(99)9999-9999" id="txtTelefone" size="20"
                                         maxlength="20" value="#{MBFornecedor.fornecedor.telefone}">
                            </p:inputMask>

                            <p:outputLabel value="Celular:" />
                            <p:inputMask mask="(99)9999-9999" id="txtCelular" size="20"
                                         maxlength="20" value="#{MBFornecedor.fornecedor.celular}">
                            </p:inputMask>

                            <p:outputLabel value="País" />

                            <p:selectOneMenu id="oneMenuPais" filter="true"
                                             value="#{MBFornecedor.pais.codigo}">
                                <f:selectItem itemValue="" itemLabel="Selecione o país"
                                              noSelectionOption="true" />
                                <f:selectItems value="#{MBFornecedor.comboPais}" var="item"
                                               itemValue="#{item.codigo}" itemLabel="#{item.pais}" />
                                <p:ajax listener="#{MBFornecedor.populaEstado}"
                                        update=":formDlgNovo:oneMenuEstado" />
                            </p:selectOneMenu>

                            <p:outputLabel for="oneMenuEstado" value="Estado:" />
                            <p:selectOneMenu id="oneMenuEstado" filter="true"
                                             value="#{MBFornecedor.estado.codigo}">
                                <f:selectItem itemValue="" itemLabel="Selecione o Estado"
                                              noSelectionOption="true" />

                                <f:selectItems value="#{MBFornecedor.comboEstado}" var="item"
                                               itemValue="#{item.codigo}" itemLabel="#{item.estado}" />
                                <p:ajax listener="#{MBFornecedor.populaCidade}"
                                        update=":formDlgNovo:oneMenuCidade" />
                            </p:selectOneMenu>

                            <p:outputLabel value="Cidade" for="oneMenuCidade" />

                            <p:selectOneMenu id="oneMenuCidade" filter="true"
                                             value="#{MBFornecedor.fornecedor.cidade.codigo}" required="true"
                                             requiredMessage="Selecione a cidade.">
                                <f:selectItem itemValue="" itemLabel="Selecione a cidade"
                                              noSelectionOption="true" />
                                <f:selectItems value="#{MBFornecedor.comboCidades}" var="item"
                                               itemValue="#{item.codigo}" itemLabel="#{item.cidade}" />
                            </p:selectOneMenu>

                            <p:outputLabel value="Cep:" />
                            <p:inputText id="txtCep" size="20" maxlength="10"
                                         value="#{MBFornecedor.fornecedor.cep}" required="true"
                                         requiredMessage="Informe o cep">
                            </p:inputText>

                            <p:outputLabel value="Bairro:" />
                            <p:inputText id="txtBairro" size="20" maxlength="20"
                                         value="#{MBFornecedor.fornecedor.bairro}" required="true"
                                         requiredMessage="Informe o bairro">
                            </p:inputText>

                            <p:outputLabel value="Rua:" />
                            <p:inputText id="txtRua" size="45" maxlength="45"
                                         value="#{MBFornecedor.fornecedor.rua}" required="true"
                                         requiredMessage="Informe o rua">
                            </p:inputText>
                            <p:outputLabel value="Complemento:" />
                            <p:inputText id="txtComplemento" size="45" maxlength="45"
                                         value="#{MBFornecedor.fornecedor.complemento}">
                            </p:inputText>

                            <p:outputLabel value="Numero:" />
                            <p:inputText id="txtNumero" size="20" maxlength="10"
                                         value="#{MBFornecedor.fornecedor.numero}" required="true"
                                         requiredMessage="Informe o numero">
                            </p:inputText>

                            <p:outputLabel value="Email" />
                            <p:inputText id="txEmail" size="45" maxlength="45"
                                         validatorMessage="Informe um email valído!"
                                         value="#{MBFornecedor.fornecedor.email}">
                                <!-- valid -->
                                <f:validateRegex
                                    pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]" />

                            </p:inputText>

                            <p:outputLabel value="Site" />
                            <p:inputText id="txtSite" size="45" maxlength="45"
                                         validatorMessage="Informe um site valido!"
                                         value="#{MBFornecedor.fornecedor.site}"
                                         requiredMessage="Informe o Site!">
                            </p:inputText>
                        </h:panelGrid>
                        <!-- actionListener="" : serve para invocar metodos manageBean -->
                        <!-- update=":formTabela:tabela" :formulario e atualiza tabela  -->

                        <!-- PF('tabelaFornecedor').clearFilters() :limpa os filtros da tabela  -->
                        <h:panelGrid columns="2">

                            <p:commandButton value="Gravar"
                                             actionListener="#{MBFornecedor.salvar}"
                                             oncomplete="verificar(xhr, status, args, 'dlgNovo', 'formCadFornecedor');"
                                             update=":formCadFornecedor:msgGlobal" />
                            <p:commandButton value="Cancelar" onclick="PF('dlgNovo').hide();"
                                             process="@this">
                                <p:resetInput target="painelDlgNovo" />
                            </p:commandButton>
                            <!-- process=@this : submete um formulario -->
                        </h:panelGrid>
                    </h:form>
                </p:dialog>




            </h:body>
        </h:form>

    </ui:define>
</ui:composition>